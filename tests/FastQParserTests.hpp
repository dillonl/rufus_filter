#ifndef RUFUS_FILTER_FASTQTESTS_HPP
#define RUFUS_FILTER_FASTQTESTS_HPP

#include "parser/FastQParser.hpp"
#include "parser/HashParser.hpp"

#include <sstream>
#include <string>
#include <bitset>

namespace
{
	std::string fastQString = "@E00121:21:H06AJALXX:2:1107:25806:32865/1\nCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCAACCCTAACCCCAACCCTAACCCTAACCCTAACCCTAACCCC\n+\n>@==?>>@?>=>>?>====?>===>?>====?>====?>====?>====?>====?>====?=====?>=====;:=>>?=>>=>??=>==??>=>=?=>>;;=><:9=<>3>>/<<,>9-/?*--/<;,5</+?,=</8?,.=/9>+99/\n@E00121:21:H06AJALXX:2:1107:3517:24462/1\nCTAACCCTAAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCAACCCTAACCCAAACCCTAACCCAACCCAAAACCTAACCAC\n+\n>@==??>@?><>==@>====?<>=>=?>:====>===;=><=;=/>====?>====?>====?>====?=====?;=>>=??>>>;==>>=>=?:>=<@?/3;>/?>>:;<>:>./8>>-4/?-:;</==;.?-/7??6/:/,@/=/+;0-\n@E00121:21:H06AJALXX:2:1112:15890:22089/1\nCTAACCCTAACCCTAACCCTAACCCTAAGCTCGGCAGTGAACACGTCTGAACTCCAGACACTGATCATAACCTCGTCTCTCACCCTCTGCTTGAAAATAAACATAACCCTAACCCTAACCCTAACCCTAACGTTAACGCTAACCTTAGCAC\n+\n>@==?>>@?>===?>=>==?>=>==?>=7)/.3*,/*.1./=<,%8=/*.=,/==6>.=>=/*.-=/>-=+=/.8..;.-./,>.@./*?/>)>,<,2?>/*/8->:-=@?>7><>?/,9-=<-:9./,=+%.4-?<%,/4;,./=>),0-\n@E00121:21:H06AJALXX:2:1117:5202:1678/1\nCTAACCCTAACCCTAACCCTAACCCTAACCCTTAACCCTAACCCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACC\n+\n>@==?>>@?>===?>====?>====?=====?=>====?>=====?>====?><===?>/====;9===;9<==;/8<:==@;<>>>;;9>>;.3/:<>/8-=>>;8.=>9?<>>>->:=>?>??>??6<:??>/-6??@/@@@6?>,;-;\n@E00121:21:H06AJALXX:2:1203:16895:50129/1\nCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTACCCTTACCCTTACCCTAACCCTTACCCTTACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTA";

	std::string hashString = "226347515391\t0\t1\tCTAACCCTAACCCTAACCCTAACCC\n343423323903\t0\t1\tTTTTCTAAAACCGGTTTTAGAAAAA\n3422229348607\t0\t1\tTTTTAAATTAATATATATGATAAAA\n9561171458431\t0\t1\tTTTGGCTGCCTACACACATCACAAA\n4247713304959\t0\t1\tTTTGGAGGGATGTTTTATGTTAAAA\n4091493075583\t0\t1\tTTTGCCATGTTTTTGCACTCTAAAA\n11218455969919\t0\t1\tTTTGAAAGGGGAAAAAAGTACCAAA\n1260484543\t0\t1\tTTTCTGTGGACATCAGAAAAAAAAA";

	TEST(FastQTests, FindTest)
	{
		auto kmers = rufus::HashParser::ParseString(hashString);

		std::stringstream ss;
		ss.str(fastQString.c_str());
		rufus::FastQParser fqparser(&ss, &std::cout, kmers, 10, 1, 20);
		fqparser.parse();
	}

	TEST(FastQTests, FindTest2)
	{
		std::string filepath = "/uufs/chpc.utah.edu/common/home/ucgdlustre/u0991464/SimonsTryAgain/14590/SSC12411.proband.k25_m0_c7.HashList";
		auto kmerSet = rufus::HashParser::ParseFile(filepath);
	}
}

#endif //RUFUS_FILTER_FASTQTESTS_HPP
